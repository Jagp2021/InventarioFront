<div class="col-12 md:col-12">
  <form
    class="field col-12"
    [formGroup]="frmEditarListaSeleccion"
    autocomplete="off"
  >
    <div class="formgrid grid">
      <div class="field col-12 md:col-5">
        <label htmlfor="nombreLista" class="frm-titulo"
          >Nombre de la lista <span class="required">*</span></label
        >

        <div class="col-10">
          <input
            pInputText
            id="nombreLista"
            type="text"
            placeholder="Escriba el nombre de la lista"
            class="p-inputtext p-component p-element"
            formControlName="nombreLista"
          />
          <small
            class="form-text text-red-600"
            *ngIf="campoNoValido('nombreLista')"
          >
            {{ listaErroresMensajes("nombreLista") }}
          </small>
        </div>
      </div>

      <div class="field col-4">
        <label htmlfor="mostrarCodigo" class="frm-titulo"
          >Mostrar el código</label
        >

        <div class="formgroup-inline">
          <div class="col-12 md:col-3">
            <div class="field-radiobutton mt-2">
              <p-radioButton
                name="mostrarCodigo"
                [value]="true"
                class="p-element"
                formControlName="mostrarCodigo"
              ></p-radioButton>
              <label for="mostrarCodigo">Si</label>
            </div>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-radiobutton mt-2">
              <p-radioButton
                name="mostrarCodigo"
                [value]="false"
                class="p-element"
                formControlName="mostrarCodigo"
              ></p-radioButton>
              <label for="mostrarCodigo">No</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>

  <div class="formgroup-inline justify-content-end">
    <button
      pButton
      pRipple
      label="agregar fila"
      icon="pi pi-plus"
      class="p-button-outlined colorAzulMHCP"
      (click)="agregarEditarFila('crear')"
    ></button>

    <button
      pButton
      pRipple
      label="registro masivo"
      icon="pi pi-calendar-plus"
      class="p-button-outlined colorAzulMHCP"
    ></button>
  </div>
  <p-table
    #dt
    styleClass="p-datatable-gridlines p-datatable-striped"
    currentPageReportTemplate="Mostrando {first} filas de {totalRecords}"
    [loading]="bMostrarLoading"
    [value]="oValoresDominio"
    [scrollable]="false"
    [rowHover]="true"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[10, 25, 50]"
    [showCurrentPageReport]="true"
  >
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="sigla">
          Código <p-sortIcon field="sigla"></p-sortIcon>
        </th>
        <th pSortableColumn="descripcion">
          Descripción <p-sortIcon field="descripcion"></p-sortIcon>
        </th>
        <th pSortableColumn="nombre">
          Nombre <p-sortIcon field="nombre"></p-sortIcon>
        </th>
        <th pSortableColumn="pci">PCI <p-sortIcon field="pci"></p-sortIcon></th>
        <th pSortableColumn="activo">
          Estado <p-sortIcon field="activo"></p-sortIcon>
        </th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-valorDominio let-ri="rowIndex">
      <tr>
        <td>{{ valorDominio.sigla }}</td>
        <td>{{ valorDominio.descripcion }}</td>
        <td>{{ valorDominio.idPerfil }}</td>
        <td>{{ valorDominio.pci }}</td>
        <td>{{ valorDominio.activo | convertirBoolean : "ai" }}</td>
        <td>
          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-pencil"
            class="p-button-rounded p-button-text p-mr-2"
            (click)="agregarEditarFila('editar', valorDominio, ri)"
            [disabled]="bEditableFila"
          ></button>
          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-trash"
            class="p-button-rounded p-button-text"
            (click)="eliminarFila(ri)"
            [disabled]="bEliminarFila"
          ></button>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6" class="text-center">
          No se han encontrado registrados.
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="col-12">
    <div class="col-12 flex justify-content-end mt-5">
      <p-button
        icon="pi pi-times"
        (click)="cancelarProceso()"
        label="Cancelar"
        class="boton-rojo p-button-text"
      ></p-button>
      <p-button
        icon="pi pi-save"
        (click)="guardarProceso()"
        label="Guardar"
      ></p-button>
    </div>
  </div>
</div>

<p-confirmDialog
  [style]="{ width: '50vw' }"
  [baseZIndex]="10000"
></p-confirmDialog>

<p-toast></p-toast>

<p-dialog
  [header]="'Modificar valores de la lista ' + sListaSeleccion.toLowerCase()"
  [(visible)]="displayModal"
  [modal]="true"
  [style]="{ width: '50vw' }"
  [baseZIndex]="10000"
  [draggable]="false"
  [resizable]="false"
>
  <form
    class="field col-12"
    [formGroup]="frmCrearValorDominio"
    autocomplete="off"
  >
    <div class="formgrid grid">
      <div class="field col-6 md:col-6">
        <label htmlfor="name1" class="frm-titulo"
          >Código <span class="required">*</span></label
        >

        <div class="col-12">
          <input
            pInputText
            id="name1"
            type="text"
            placeholder="Nuevo PCP gasto"
            class="p-inputtext p-component p-element"
            formControlName="sigla"
            autofocus
          />
          <small class="form-text text-red-600" *ngIf="campoNoValido('sigla')">
            {{ listaErroresMensajes("sigla") }}
          </small>
        </div>
      </div>

      <div class="field col-6 md:col-6">
        <label htmlfor="name1" class="frm-titulo"
          >Descripción <span class="required">*</span></label
        >

        <div class="col-12">
          <input
            pInputText
            id="name1"
            type="text"
            placeholder="Nuevo plan de cuentas de ejecución"
            class="p-inputtext p-component p-element"
            formControlName="descripcion"
          />
          <span
            class="form-text text-red-600"
            *ngIf="campoNoValido('descripcion')"
          >
            {{ listaErroresMensajes("descripcion") }}
          </span>
        </div>
      </div>

      <div class="field col-6 md:col-6" *ngIf="bEditando">
        <label htmlfor="pci" class="frm-titulo">PCI</label>

        <div class="col-12">
          <input
            pInputText
            id="pci"
            type="text"
            class="p-inputtext"
            [disabled]="bNoMostrar"
            formControlName="pci"
          />
        </div>
      </div>

      <div class="field col-6 md:col-6" *ngIf="bEditando">
        <label htmlfor="name1" class="frm-titulo">Nombre perfil</label>

        <div class="col-12">
          <input
            pInputText
            id="nombrePerfil"
            type="text"
            class="p-inputtext"
            formControlName="idPerfil"
          />
        </div>
      </div>

      <div class="field col-6 md:col-6">
        <label htmlfor="name1" class="frm-titulo"
          >Estado <span class="required">*</span></label
        >

        <div class="col-12">
          <p-dropdown
            [options]="oEstado"
            [filter]="false"
            placeholder="Selecionar estado"
            formControlName="activo"
            optionValue="valor"
            optionLabel="estado"
          >
          </p-dropdown>
        </div>
      </div>
    </div>

    <div class="col-12 flex justify-content-end mt-5">
      <p-button
        icon="pi pi-times"
        (click)="cerrarModal()"
        label="Cancelar"
        class="boton-rojo p-button-text"
      ></p-button>
      <p-button
        icon="pi pi-save"
        label="Guardar"
        [disabled]="frmCrearValorDominio.invalid"
        (click)="guardarTemporalValorDominio()"
      ></p-button>
    </div>
  </form>
</p-dialog>
