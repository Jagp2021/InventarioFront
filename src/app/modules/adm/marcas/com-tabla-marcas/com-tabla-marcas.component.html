<!-- Toast -->
<p-toast></p-toast>

<!-- Código base -->
<div class="grid">
  <div class="col-12 md:col-12 lg:col-12">
    <div class="w-full surface-card border-round espacio-cardMHCP">
      <div class="paginaMHCP">
        <div class="flex col-12 md:col-12 lg:col-12 paginaMHCP-header">
          <div class="col-8 md:col-8 lg:col-8 p-0 paginaMHCP-header-titulo">
            <app-lbl-titulo
              titulo="Marcas Función"
              descripcion='Crear marcas con sus valores, para cada una de las "funciones de catálogo", estas marcas son adicionales a las básicas que están previamente definidas en los requerimientos de cada uno de los catálogos.'
            ></app-lbl-titulo>
          </div>
          <div class="col-4 md:col-4 lg:col-4 p-0 paginaMHCP-accionPrincipal">
            <button
              pButton
              pRipple
              label="crear"
              icon="pi pi-plus"
              class="p-button-success"
              [routerLink]="['crearMarca']"
            ></button>
          </div>
        </div>

        <div class="paginaMHCP-contenedor">
          <div class="col-12 md:col-12 lg:col-12 espacio-pb30MHCP">
            <app-lbl-subtitulo
              subtitulo="Marcas existentes"
              [bEsSubtituloPrincipal]="false"
            ></app-lbl-subtitulo>

            <form class="col-12 p-0">
              <div class="formgrid grid">
                <div class="field col-4 md:col-4">
                  <label class="frm-titulo">Función catálogo</label>
                  <p-dropdown
                    name="description"
                    [options]="listaFuncionCatalogo"
                    [(ngModel)]="selectedItem"
                    optionLabel="descripcion"
                    [filter]="true"
                    filterBy="descripcion"
                    [showClear]="false"
                    placeholder="Selecionar función de catálogo"
                  >
                    <ng-template pTemplate="selectedItem">
                      <div
                        class="country-item country-item-value"
                        *ngIf="selectedItem"
                      >
                        <div>{{ selectedItem.descripcion }}</div>
                      </div>
                    </ng-template>
                    <ng-template let-dominio pTemplate="item">
                      <div class="dominio-item">
                        <div>{{ dominio.descripcion }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                </div>

                <div class="field col-3 md:col-3 mt-3">
                  <button
                    pButton
                    pRipple
                    type="button"
                    label="Buscar"
                    class="p-button-success p-button-succes"
                    icon="pi pi-search"
                    (click)="listarValoresMarcaFuncion()"
                  ></button>
                </div>
              </div>
            </form>
          </div>

          <div class="col-12 md:col-12 lg:col-12 p-0">
            <p-table
              #dt
              styleClass="p-datatable-gridlines p-datatable-striped"
              currentPageReportTemplate="Mostrando {first} filas de {totalRecords}"
              selectionMode="single"
              [loading]="loadingTabla"
              [value]="listaMarcas"
              [scrollable]="false"
              [rowHover]="true"
              [paginator]="listaMarcas.length > 10"
              [rows]="10"
              [rowsPerPageOptions]="[5, 10, 25, 50]"
              [showCurrentPageReport]="true"
              [globalFilterFields]="['nombre', 'dominio', 'estado', 'tipoDato']"
            >
              <ng-template pTemplate="header">
                <tr>
                  <th pSortableColumn="nombre">
                    Nombre <p-sortIcon field="nombre"></p-sortIcon>
                  </th>
                  <th pSortableColumn="funcionCatalogo">
                    Dominio <p-sortIcon field="funcionCatalogo"></p-sortIcon>
                  </th>
                  <th pSortableColumn="activo">
                    Estado <p-sortIcon field="activo"></p-sortIcon>
                  </th>
                  <th pSortableColumn="tipoDato">
                    Tipo de marca <p-sortIcon field="tipoDato"></p-sortIcon>
                  </th>
                </tr>
              </ng-template>

              <ng-template
                pTemplate="body"
                let-listaMarcas
                let-editing="editing"
                let-ri="rowIndex"
              >
                <tr
                  (mouseenter)="
                    fnMostrarOcultarBotones($event, ri, true, 'tb-trmarcs')
                  "
                  (mouseleave)="
                    fnMostrarOcultarBotones($event, ri, false, 'tb-trmarcs')
                  "
                  [pSelectableRow]="listaMarcas"
                >
                  <td>{{ listaMarcas.nombre }}</td>
                  <td>{{ listaMarcas.descripcionTipoDato }}</td>
                  <td>{{ listaMarcas.activo | convertirBoolean : "ai" }}</td>
                  <td>{{ listaMarcas.descripcionTipoMarca }}</td>

                  <div id="button-{{ ri }}-tb-trmarcs" class="no-mostrar">
                    <button
                      pButton
                      pRipple
                      Tooltip="Editar"
                      tooltipPosition="top"
                      type="button"
                      icon="pi pi-pencil"
                      class="botonTableMHCP p-button-success colorVerdeMHCP"
                      (click)="editarMarca('editar', listaMarcas)"
                    ></button>
                    <button
                      *ngIf="listaMarcas.activo != false"
                      pButton
                      pRipple
                      pTooltip="Eliminar"
                      tooltipPosition="top"
                      type="button"
                      icon="pi pi-trash"
                      class="botonTableMHCP colorRojoMHCP"
                      (click)="eliminarMarca(listaMarcas, ri)"
                    ></button>
                  </div>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="5" class="text-center">
                    No se han encontrado registrados.
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
